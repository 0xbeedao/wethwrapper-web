"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.setupMultiplex = void 0;

var _objMultiplex = _interopRequireDefault(require("obj-multiplex"));

var _pump = _interopRequireDefault(require("pump"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Sets up stream multiplexing for the given stream
 * @param {any} connectionStream - the stream to mux
 * @return {stream.Stream} the multiplexed stream
 */
var setupMultiplex = function setupMultiplex(connectionStream) {
  var mux = new _objMultiplex.default(); // bind helper method to get previously created streams

  mux.getStream = function (name) {
    if (this._substreams[name]) {
      return this._substreams[name];
    } else {
      return this.createStream(name);
    }
  };

  (0, _pump.default)(connectionStream, mux, connectionStream, function (err) {
    if (err) console.error(err);
  });
  return mux;
};

exports.setupMultiplex = setupMultiplex;